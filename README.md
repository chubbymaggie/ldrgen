# ldrgen

This is ldrgen, a small experimental random C program generator.


## Introduction

This program is a generator of C code: On every call it generates a new
random C function and prints it to the standard output. The generator is
"liveness-driven", which means that it tries to avoid generating dead code:
All the computations it generates are (in a certain, limited sense) actually
used to compute the function's return value. Other than this, ldrgen does
not do much to ensure that its output resembles anything like "real"
programs.

See [Csmith](https://github.com/csmith-project/csmith) for another C program
generator that is in many ways more sophisticated than this.


## Examples

Here is a small example program generated by ldrgen:

```c
/* Generated by Frama-C */
// Generated by ldrgen
// Seed: 518861354
// Command line arguments: -ldrgen -ldrgen-stmt-depth 2 -ldrgen-expr-depth 3
double fn1(unsigned long p, char p_9, double p_13, long p_15,
           unsigned short p_17, unsigned char p_19, unsigned int p_21,
           char p_25)
{
  unsigned short v_61;
  unsigned long long v_59;
  unsigned char v_57;
  signed char v_55;
  short v_53;
  unsigned char v_51;
  unsigned int v_49;
  signed char v_47;
  unsigned int v_45;
  long long v_43;
  double v_41;
  double v_39;
  unsigned long long v_37;
  char v_35;
  long long v_33;
  unsigned int v_31;
  float v_29;
  float v_27;
  long long v_23;
  unsigned short v_11;
  short v_7;
  signed char v_5;
  unsigned long v;
  double result;
  v_61 = (unsigned short)20118;
  v_59 = 18446744073651884177ULL;
  v_53 = (short)p_9;
  v_51 = (unsigned char)p;
  v_49 = 3622462214U;
  v_47 = (signed char)p_15;
  v_41 = 8.81391106246e+37;
  v_39 = (double)p_21;
  v_37 = 49912ULL;
  v_35 = (char)p_15;
  v_23 = (long long)p_25;
  result = 570792207.933;
  v_33 = (long long)(! ((long)result / -435078036L + (long)p_13));
  while ((long long)(! ((unsigned int)v_41 - p_21)) / (v_43 + 235LL) != ! (
         (long long)(v_45 * (unsigned int)-2.05306961165e+38f) + -320956805LL / (long long)(
                                                                 (int)v_47 + 675))) {
    v_57 = v_49 - 4294967268U;
    v_35 = (char)(~ ((unsigned int)v_51 % 771208090U) << ((~ v_37 | (unsigned long long)v_61) & 31ULL));
    v_55 = (signed char)((double)(- v_59) * ((double)p_19 - -7.92010115044e+37) - (double)0);
    v_45 = (unsigned int)(! p * ((unsigned long)p_19 * (p - 4294967178UL)));
    v_33 = (long long)(((unsigned long)(- v_57) | 344866612UL) % (unsigned long)(
                       (int)p_17 % 50 + 927));
    v_43 = (long long)(- (- p_13 - (double)((int)v_53 + (int)v_55)));
  }
  v_31 = (unsigned int)((unsigned long long)(~ (- v_33)) - ((unsigned long long)v_35 + (
                                                            v_37 - (unsigned long long)v_39)));
  if (-5861229920.96f >= (float)(! (- (- v_31)))) {
    v_11 = (unsigned short)((long long)((unsigned int)p_19 / (341712740U / (
                                                              p_21 + 753U) + 784U)) | 
                            (v_23 * -51280235LL) * 74LL);
    v = (unsigned long)p_17;
    v_7 = (short)((int)v_11 * (int)((unsigned short)((double)(short)-18442 * (
                                                     p_13 / ((double)p_15 + (double)555)))));
    v_5 = (signed char)p_9;
    result = (double)((v ^ (42UL + p)) / (unsigned long)((int)(~ v_5) / (
                                                         ((int)v_7 - (int)v_5) + 851) + 112));
  }
  else {
    v_29 = (float)(unsigned short)64319;
    v_27 = v_29;
    result = (double)((float)p_25 / ((v_27 + (float)p) + (float)366));
  }
  return result;
}
```


## TODOs

Many more C language constructs should be added.


## Installation

This program is implemented as a plugin for Frama-C <http://frama-c.com/>.
It should run on all Unix-like platforms with Frama-C and standard build
tools.

Your favorite package manager may provide a Frama-C package that installs
all you need. Otherwise, the easiest way to install Frama-C is to first
install OPAM, the OCaml package manager <http://opam.ocaml.org/>. You can
then run

    opam install frama-c

or

    opam install frama-c-base

The latter should ask you for fewer additional system libraries to install,
but I have not tested ldrgen with it.

With Frama-C installed and the `frama-c` executable in your path, you can
compile ldrgen by running `make` and install it with `make install`. It will
be installed in Frama-C's plugin directory. You can remove it again by
running `make uninstall`.

For now, run ldrgen as `frama-c -ldrgen`. See `frama-c -ldrgen-h` for
documentation on some command-line flags that can affect the generated code.


## Contact

This program was written by Gerg√∂ Barany <gergo@tud.at>. It lives at
<https://github.com/gergo-/ldrgen>.

Comments, questions, bug reports, feature requests, and patches are welcome!


## Copying

This program is free software: you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the Free
Software Foundation, either version 3 of the License, or (at your option)
any later version.

This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
more details.

You should have received a copy of the GNU General Public License along with
this program (file LICENSE). If not, see <http://www.gnu.org/licenses/>.
